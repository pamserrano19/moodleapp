{"version":3,"sources":["./src/core/features/login/guards/has-sites.ts","./src/core/features/login/login-lazy.module.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAAqC;AACrC,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,iDAAiD;AACjD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAEU;AAGC;AACM;AACb;AAEsB;IAG9C,sBAAsB,SAAtB,sBAAsB;IAE/B;;OAEG;IACH,WAAW;QACP,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC;IACxB,CAAC;IAED;;OAEG;IACH,OAAO;QACH,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC;IACxB,CAAC;IAED;;OAEG;IACW,KAAK;;YACf,MAAM,KAAK,GAAG,MAAM,+DAAS,CAAC,YAAY,CAAC,yDAAS,CAAC,QAAQ,EAAE,EAAE,EAAE,CAAC,CAAC;YAErE,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClB,OAAO,IAAI,CAAC;aACf;YAED,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,GAAG,sEAAe,CAAC,mBAAmB,EAAE,CAAC;YAC7D,MAAM,KAAK,GAAG,kDAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAEpC,KAAK,CAAC,WAAW,GAAG,MAAM,CAAC;YAE3B,OAAO,KAAK,CAAC;QACjB,CAAC;KAAA;CAEJ;AAlCY,sBAAsB;IADlC,gEAAU,CAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAC;GACtB,sBAAsB,CAkClC;AAlCkC;;;;;;;;;;;;;ACxBnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAAqC;AACrC,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,iDAAiD;AACjD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAEQ;AACc;AAEC;AACI;AACe;AAE3E,MAAM,MAAM,GAAW;IACnB;QACI,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,MAAM;QACjB,UAAU,EAAE,OAAO;KACtB;IACD;QACI,IAAI,EAAE,MAAM;QACZ,YAAY,EAAE,GAAG,EAAE,CAAC,0WAAkC,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,uBAAuB,CAAC;KAC/F;IACD;QACI,IAAI,EAAE,aAAa;QACnB,YAAY,EAAE,GAAG,EAAE,CAAC,4QAAgD,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,8BAA8B,CAAC;KACpH;IACD;QACI,IAAI,EAAE,OAAO;QACb,YAAY,EAAE,GAAG,EAAE,CAAC,4NAAoC,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,wBAAwB,CAAC;QAC/F,OAAO,EAAE,CAAC,wEAAsB,CAAC;QACjC,WAAW,EAAE,CAAC,wEAAsB,CAAC;KACxC;IACD;QACI,IAAI,EAAE,mBAAmB;QACzB,YAAY,EAAE,GAAG,EAAE,CAAC,oUAA8D;aAC7E,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,oCAAoC,CAAC;KAC1D;IACD;QACI,IAAI,EAAE,gBAAgB;QACtB,YAAY,EAAE,GAAG,EAAE,CAAC,4SAAwD;aACvE,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,iCAAiC,CAAC;KACvD;IACD;QACI,IAAI,EAAE,YAAY;QAClB,YAAY,EAAE,GAAG,EAAE,CAAC,4QAAgD,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,6BAA6B,CAAC;KACnH;IACD;QACI,IAAI,EAAE,aAAa;QACnB,YAAY,EAAE,GAAG,EAAE,CAAC,oRAAkD,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,8BAA8B,CAAC;KACtH;IACD;QACI,IAAI,EAAE,WAAW;QACjB,YAAY,EAAE,GAAG,EAAE,CAAC,4PAA4C,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,4BAA4B,CAAC;KAC9G;CACJ,CAAC;IASW,mBAAmB,SAAnB,mBAAmB;CAAG;AAAtB,mBAAmB;IAP/B,8DAAQ,CAAC;QACN,OAAO,EAAE;YACL,oEAAgB;YAChB,uFAAyB;YACzB,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;SAChC;KACJ,CAAC;GACW,mBAAmB,CAAG;AAAH","file":"login-lazy-module.js","sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Injectable } from '@angular/core';\r\nimport { CanActivate, CanLoad, UrlTree } from '@angular/router';\r\n\r\nimport { CoreSites } from '@services/sites';\r\nimport { CoreUtils } from '@services/utils/utils';\r\nimport { Router } from '@singletons';\r\n\r\nimport { CoreLoginHelper } from '../services/login-helper';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class CoreLoginHasSitesGuard implements CanActivate, CanLoad {\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    canActivate(): Promise<true | UrlTree> {\r\n        return this.guard();\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    canLoad(): Promise<true | UrlTree> {\r\n        return this.guard();\r\n    }\r\n\r\n    /**\r\n     * Check if the user has any sites stored.\r\n     */\r\n    private async guard(): Promise<true | UrlTree> {\r\n        const sites = await CoreUtils.ignoreErrors(CoreSites.getSites(), []);\r\n\r\n        if (sites.length > 0) {\r\n            return true;\r\n        }\r\n\r\n        const [path, params] = CoreLoginHelper.getAddSiteRouteInfo();\r\n        const route = Router.parseUrl(path);\r\n\r\n        route.queryParams = params;\r\n\r\n        return route;\r\n    }\r\n\r\n}\r\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { CoreSharedModule } from '@/core/shared.module';\nimport { CoreLoginHasSitesGuard } from './guards/has-sites';\nimport { CoreLoginComponentsModule } from './components/components.module';\n\nconst routes: Routes = [\n    {\n        path: '',\n        pathMatch: 'full',\n        redirectTo: 'sites',\n    },\n    {\n        path: 'site',\n        loadChildren: () => import('./pages/site/site.module').then( m => m.CoreLoginSitePageModule),\n    },\n    {\n        path: 'credentials',\n        loadChildren: () => import('./pages/credentials/credentials.module').then( m => m.CoreLoginCredentialsPageModule),\n    },\n    {\n        path: 'sites',\n        loadChildren: () => import('./pages/sites/sites.module').then( m => m.CoreLoginSitesPageModule),\n        canLoad: [CoreLoginHasSitesGuard],\n        canActivate: [CoreLoginHasSitesGuard],\n    },\n    {\n        path: 'forgottenpassword',\n        loadChildren: () => import('./pages/forgotten-password/forgotten-password.module')\n            .then( m => m.CoreLoginForgottenPasswordPageModule),\n    },\n    {\n        path: 'changepassword',\n        loadChildren: () => import('./pages/change-password/change-password.module')\n            .then( m => m.CoreLoginChangePasswordPageModule),\n    },\n    {\n        path: 'sitepolicy',\n        loadChildren: () => import('./pages/site-policy/site-policy.module').then( m => m.CoreLoginSitePolicyPageModule),\n    },\n    {\n        path: 'emailsignup',\n        loadChildren: () => import('./pages/email-signup/email-signup.module').then( m => m.CoreLoginEmailSignupPageModule),\n    },\n    {\n        path: 'reconnect',\n        loadChildren: () => import('./pages/reconnect/reconnect.module').then( m => m.CoreLoginReconnectPageModule),\n    },\n];\n\n@NgModule({\n    imports: [\n        CoreSharedModule,\n        CoreLoginComponentsModule,\n        RouterModule.forChild(routes),\n    ],\n})\nexport class CoreLoginLazyModule {}\n"],"sourceRoot":"webpack:///"}